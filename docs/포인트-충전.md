
---

##  포인트 충전

**요구사항:**

* 사용자는 토스페이먼츠 기반 결제를 통해 자사 서비스 포인트를 충전할 수 있어야 함
* 포인트는 **1원당 1포인트** 기준으로 적립됨
* 실제 결제 연동 대신 **FakePaymentGateway**를 통해 테스트 환경 지원
* 결제 수단은 `"fake"` 문자열을 통해 지정하고, 내부에서 전략 패턴 기반으로 게이트웨이를 분기 처리함

---

###  테스트 조건

* 사용자 ID: `1`
* 결제 수단: `"fake"`
* 충전 요청 금액: `10,000원`
* 쿠폰 없이 단순 충전

요청 본문 예시:

```json
{
  "userId": 1,
  "paymentKey": "pay_abc123",
  "pointAmount": 10000,
  "method": "fake",
  "couponId": null
}
```

---

###  적용 기술 요약

| 항목                | 설명                                                                                                   |
| ----------------- | ---------------------------------------------------------------------------------------------------- |
| **전략 패턴**         | `PaymentGateway` 인터페이스 구현체로 `TossPaymentGateway`, `FakePaymentGateway` 등 구현체 분기                      |
| **Gateway 선택 방식** | 요청에서 전달받은 `method` 값을 `PaymentMethod.from(String)` 으로 변환 후, `gatewayMap.get(beanName)` 으로 주입된 구현체 선택 |
| **Mapper 사용**     | 결제 요청 DTO → 도메인 → 결과 DTO로 변환하여 반환                                                                    |

---

###  기대 결과

* 결제가 성공적으로 처리되면 `orderId`, `amount`, `status`, `approvedAt` 등의 정보가 응답됨
* 포인트는 충전 금액만큼 적립됨

---

###  테스트 결과

* 충전 성공 및 포인트 적립이 정상적으로 동작함을 확인
* 응답 JSON 및 동작 확인은 아래 이미지 참고

<br>

<img src="../images/payment-charge-example.png" width="700"/>

---
